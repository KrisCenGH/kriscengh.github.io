import{p as g}from"./pinyin-JC0mu4G_.js";import{_ as L,r as p,j as x,i as v,q as A,c as i,a,F as h,s as k,t as _,d as F,o as c,A as R}from"./index-gVKdl7Fj.js";const B={class:"add-member"},E={class:"letter"},M=["onClick"],S=["src"],T={class:"name"},U={class:"bottem-bar"},z=["disabled"],Z="http://142.171.30.197:10086",$={__name:"AddMember",setup(j){const b=A(),f=F(),u=p({}),d=p([]);x(async()=>{const{members:s}=await v.post("/groups/members",{groupId:b.params.targetId});d.value=s;const{friends:e}=await v.post("/friends");e.slice().sort((n,t)=>{const o=m(n.username),I=m(t.username);return o.localeCompare(I)}).forEach(n=>{const t=m(n.username),o=/^[A-Z]$/.test(t)?t:"#";u.value[o]||(u.value[o]=[]),u.value[o].push(n)})});function m(s){if(!s)return"#";const e=s[0];return/[\u4e00-\u9fa5]/.test(e)?g(e,{style:g.STYLE_FIRST_LETTER})[0][0].toUpperCase():/[a-zA-Z]/.test(e)?e.toUpperCase():"#"}const r=p([]);function y(s){if(d.value.some(l=>l.id===s))return;const e=r.value.indexOf(s);e===-1?r.value.push(s):r.value.splice(e,1)}async function C(){try{const{success:s}=await v.post("/groups/add-members",{groupId:b.params.targetId,userIds:r.value});window.alert("邀请成功！"),f.back()}catch{window.alert("邀请失败！")}}function w(){f.back()}return(s,e)=>(c(),i("div",B,[a("div",{class:"top-bar"},[a("div",{class:"back-triangle",onClick:w}),e[0]||(e[0]=a("div",{class:"title"},"选择联系人",-1))]),e[1]||(e[1]=a("div",{class:"placeholder-div"},null,-1)),(c(!0),i(h,null,k(u.value,(l,n)=>(c(),i("div",null,[a("div",E,_(n),1),(c(!0),i(h,null,k(l,t=>(c(),i("div",{class:"friend",onClick:o=>y(t.id)},[a("div",{class:R(["checkbox",{checked:r.value.includes(t.id)||d.value.some(o=>o.id===t.id),ismember:d.value.some(o=>o.id===t.id)}])},null,2),a("img",{src:Z+t.avatar_url,class:"avatar"},null,8,S),a("div",T,_(t.username),1)],8,M))),256))]))),256)),e[2]||(e[2]=a("div",{class:"placeholder-div"},null,-1)),a("div",U,[a("button",{class:"add-button",disabled:r.value.length<1,onClick:C}," 完成"+_(r.value.length?"("+r.value.length+")":""),9,z)])]))}},G=L($,[["__scopeId","data-v-45c514b6"]]);export{G as default};
