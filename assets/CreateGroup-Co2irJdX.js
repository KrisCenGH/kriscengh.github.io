import{_ as y,r as p,j as x,i as v,c as l,a as s,t as m,w as F,v as I,F as g,s as h,d as L,o as i,A as B}from"./index-BN88ZBUW.js";import{p as k}from"./pinyin-JC0mu4G_.js";const E={class:"create-group"},R={class:"top-bar"},T=["disabled"],U={class:"name-input-container"},A={class:"letter"},G=["onClick"],S=["src"],z={class:"name"},D="http://localhost:3000",M={__name:"CreateGroup",setup(N){const _=L(),c=p({});x(async()=>{const{friends:t}=await v.post("/friends");t.slice().sort((n,r)=>{const a=d(n.username),f=d(r.username);return a.localeCompare(f)}).forEach(n=>{const r=d(n.username),a=/^[A-Z]$/.test(r)?r:"#";c.value[a]||(c.value[a]=[]),c.value[a].push(n)})});function d(t){if(!t)return"#";const e=t[0];return/[\u4e00-\u9fa5]/.test(e)?k(e,{style:k.STYLE_FIRST_LETTER})[0][0].toUpperCase():/[a-zA-Z]/.test(e)?e.toUpperCase():"#"}const u=p(""),o=p([]);function w(t){const e=o.value.indexOf(t);e===-1?o.value.push(t):o.value.splice(e,1)}async function C(){if(u.value===""){window.alert("请输入群名！");return}try{const{groupId:t}=await v.post("/groups/create",{name:u.value}),{message:e}=await v.post("/groups/add-members",{groupId:t,userIds:o.value});window.alert("群聊创建成功！"),_.replace({name:"groupChat",params:{targetId:t}})}catch{window.alert("群聊创建失败！")}}function b(){_.back()}return(t,e)=>(i(),l("div",E,[s("div",R,[s("div",{class:"back-triangle",onClick:b}),e[1]||(e[1]=s("div",{class:"title"},"发起群聊",-1)),s("button",{class:"create-button",disabled:o.value.length<1,onClick:C}," 完成"+m(o.value.length?"("+o.value.length+")":""),9,T)]),e[2]||(e[2]=s("div",{class:"top-placeholder-div"},null,-1)),s("div",U,[F(s("input",{type:"text",class:"name-input",placeholder:"请输入群聊名称","onUpdate:modelValue":e[0]||(e[0]=n=>u.value=n)},null,512),[[I,u.value]])]),(i(!0),l(g,null,h(c.value,(n,r)=>(i(),l("div",{class:"friends-list",key:r},[s("div",A,m(r),1),(i(!0),l(g,null,h(n,a=>(i(),l("div",{class:"friend",onClick:f=>w(a.id)},[s("div",{class:B(["checkbox",{checked:o.value.includes(a.id)}])},null,2),s("img",{src:D+a.avatar_url,class:"avatar"},null,8,S),s("div",z,m(a.username),1)],8,G))),256))]))),128))]))}},$=y(M,[["__scopeId","data-v-72d2bb1d"]]);export{$ as default};
